From a7245256ba4901d387e932dd1f7830da712baa56 Mon Sep 17 00:00:00 2001
From: Scott Todd <scott.todd0@gmail.com>
Date: Tue, 1 Jul 2025 14:34:35 -0700
Subject: [PATCH 4/5] Run rocblas_gentest.py under `python` on Windows.

---
 clients/common/rocblas_parse_data.cpp | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/clients/common/rocblas_parse_data.cpp b/clients/common/rocblas_parse_data.cpp
index 83039751..399a709f 100644
--- a/clients/common/rocblas_parse_data.cpp
+++ b/clients/common/rocblas_parse_data.cpp
@@ -47,15 +47,20 @@ static std::string rocblas_parse_yaml(const std::string& yaml)
         yaml_path = yaml;
     }
 
-    auto cmd = exepath + "rocblas_gentest.py --template " + exepath + "rocblas_template.yaml -o "
+#ifdef WIN32
+    // Windows prefers to only run certain file extensions as executables, so run under 'python'.
+    auto cmd = "python " + exepath + "rocblas_gentest.py --template " + exepath + "rocblas_template.yaml -o "
                + tmp + " " + yaml_path;
     rocblas_cerr << cmd << std::endl;
-
-#ifdef WIN32
     int status = std::system(cmd.c_str());
     if(status == -1)
         exit(EXIT_FAILURE);
 #else
+    // Linux can run the python script directly thanks to the `#!/usr/bin/env python3` shebang.
+    // If we ran 'python' as above, we might fail unless python-is-python3 (or equivalent) is configured.
+    auto cmd = exepath + "rocblas_gentest.py --template " + exepath + "rocblas_template.yaml -o "
+               + tmp + " " + yaml_path;
+    rocblas_cerr << cmd << std::endl;
     int status = system(cmd.c_str());
     if(status == -1 || !WIFEXITED(status) || WEXITSTATUS(status))
         exit(EXIT_FAILURE);
-- 
2.47.1.windows.2

