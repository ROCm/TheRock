# Traverse from lib/cmake/FOO -> the directory holding lib
get_filename_component(_IMPORT_PREFIX "${CMAKE_CURRENT_LIST_DIR}" PATH)
get_filename_component(_IMPORT_PREFIX "${_IMPORT_PREFIX}" PATH)
get_filename_component(_IMPORT_PREFIX "${_IMPORT_PREFIX}" PATH)
if(_IMPORT_PREFIX STREQUAL "/")
  set(_IMPORT_PREFIX "")
endif()

if(NOT TARGET BZip2::BZip2)
  if(@BUILD_SHARED_LIBS@)
    add_library(BZip2::BZip2 SHARED IMPORTED)
    set_target_properties(BZip2::BZip2 PROPERTIES
      INTERFACE_INCLUDE_DIRECTORIES "${_IMPORT_PREFIX}/include"
      IMPORTED_LOCATION "${_IMPORT_PREFIX}/@INSTALL_SHLIB_DIR@/@CMAKE_SHARED_LIBRARY_PREFIX@rocm_sysdeps_bz2@CMAKE_SHARED_LIBRARY_SUFFIX@"
    )
  else()
    add_library(BZip2::BZip2 SHARED IMPORTED)
    set_target_properties(BZip2::BZip2 PROPERTIES
      INTERFACE_INCLUDE_DIRECTORIES "${_IMPORT_PREFIX}/include"
      IMPORTED_LOCATION "${_IMPORT_PREFIX}/lib/@CMAKE_STATIC_LIBRARY_PREFIX@rocm_sysdeps_bz2@CMAKE_STATIC_LIBRARY_SUFFIX@"
    )
  endif()
  if(WIN32)
      get_target_property(_loc BZip2::BZip2 IMPORTED_LOCATION)
    if(_loc)
        set_target_properties(BZip2::BZip2 PROPERTIES IMPORTED_IMPLIB "${_loc}")
    endif()
  endif()
endif()

set(_IMPORT_PREFIX)
