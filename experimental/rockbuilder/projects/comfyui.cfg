[project_info]
name=comfyui
version=v0.3.40
repo_url=https://github.com/comfyanonymous/ComfyUI

skip_windows=YES

env_common=INSTALL_DIR_PREFIX_APP=${ROCM_HOME}/apps/comfyui

cmd_exec_dir=${ROCK_BUILDER_APP_SRC_DIR}
init_cmd = python -m pip install -r ./requirements.txt
install_cmd = mkdir -p ${INSTALL_DIR_PREFIX_APP}
              cd ${ROCK_BUILDER_APP_SRC_DIR}
              git archive HEAD | tar -x -C ${INSTALL_DIR_PREFIX_APP}
              echo "cd ${ROCM_HOME}/apps/comfyui" > ${ROCM_HOME}/bin/comfyui.sh
              echo "export LD_LIBRARY_PATH=${ROCM_HOME}/lib:${ROCM_HOME}/lib/llvm/lib:${LD_LIBRARY_PATH}" >> ${ROCM_HOME}/bin/comfyui.sh
              echo "python main.py" >> ${ROCM_HOME}/bin/comfyui.sh
              chmod u+x ${INSTALL_DIR_PREFIX_ROCM}/bin/comfyui.sh
